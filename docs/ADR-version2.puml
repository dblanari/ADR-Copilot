@startuml
skinparam componentStyle rectangle
skinparam wrapWidth 200
title ADR Automation â€“ High-level Components

package "Producers / Sources" {
  [Jira] as JIRA
  [Git / CI] as GIT
  [Docs / Wikis] as DOCS
}

component "Input Gateway API" as GATEWAY
component "Topic (Kafka)" as BUS
component "Ingestion & Embedding\n(chunk, embed)" as INGEST
database "Vector DB\n(Pinecone/Weaviate/Chroma)" as VDB
database "Metadata Store\n(PostgreSQL)" as SQL
component "ADR Trigger Service\n(rules + classifier + OPA)" as TRIGGER
component "Retrieval Service\n(Vector kNN + filters + re-ranker)" as RETR
component "LLM Orchestrator\n(ADR Generator)" as LLM
component "Workflow Engine\n(Temporal/Cadence)" as WF
node "Review UI\n(GitHub Web UI)" as REVIEW_UI
component "Notifications\n(Email/Teams)" as NOTIF

JIRA --> GATEWAY
GIT --> GATEWAY
DOCS --> GATEWAY

GATEWAY --> BUS
BUS --> INGEST
INGEST --> VDB
INGEST --> SQL

' Triggers on events or labels
BUS --> TRIGGER
TRIGGER --> WF : create ADR proposal

' Retrieval and generation path
TRIGGER --> RETR : Decision Intent
RETR --> VDB : vector search
RETR --> SQL : metadata filters
RETR --> LLM : Context Pack

LLM --> WF : Draft ADR + Evidence

' Human-in-the-loop
WF --> REVIEW_UI : task: review draft (GitHub PR)
REVIEW_UI --> WF : approve / reject (GitHub review)
WF --> VDB : index ADR (on approval)

' Notifications
WF --> NOTIF : review requested / published
@enduml